These code is not portable... So they just illustrate the idea of the program.
The midi files are generated by the program, so please enjoy~.